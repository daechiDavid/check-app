<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìƒ ì¶œì„ì²´í¬ ë° ê³¼ì œì œì¶œ ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #007bff;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
        }

        .content {
            display: none;
        }

        .content.active {
            display: block;
        }

        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .student-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .student-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .student-btn:hover::before {
            left: 100%;
        }

        /* ì¶œì„ ìƒíƒœ */
        .student-btn.absent {
            background: #6c757d;
            color: white;
        }

        .student-btn.present {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        /* ê³¼ì œì œì¶œ ìƒíƒœ */
        .student-btn.not-submitted {
            background: #6c757d;
            color: white;
        }

        .student-btn.submitted {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .student-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .student-btn:active {
            transform: translateY(0);
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .control-btn {
            background: linear-gradient(135deg, #6f42c1, #e83e8c);
            color: white;
            border: none;
            padding: 12px 25px;
            margin: 0 10px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }        .summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.1em;
            color: #495057;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .student-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .student-status {
            font-size: 0.9em;
        }

        .upload-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .upload-section h3 {
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        .file-input-label {
            display: inline-block;
            padding: 12px 25px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .format-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }

        .format-info h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .format-info code {
            background: #fff;
            padding: 2px 6px;
            border-radius: 4px;
            color: #d63384;
        }

        .current-list {
            background: #fff;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .current-list h4 {
            color: #495057;
            margin-bottom: 10px;
            text-align: center;
        }

        .student-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }        .student-number {
            font-weight: bold;
            color: #007bff;
            margin-right: 10px;
        }

        .add-student-section {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #28a745;
        }

        .add-student-section h4 {
            color: #155724;
            margin-bottom: 15px;
            text-align: center;
        }

        .add-form {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .add-input {
            padding: 10px 15px;
            border: 2px solid #28a745;
            border-radius: 8px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
        }

        .add-input:focus {
            border-color: #20c997;
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.1);
        }

        .add-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.3s ease;
        }        .delete-btn:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            position: fixed;
            left: -250px;
            top: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            z-index: 1000;
            transition: left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }        .sidebar-nav {
            padding: 20px 0;
            flex: 1;
            overflow-y: auto;
        }

        .sidebar-item {
            display: block;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            font-size: 1.1em;
            transition: all 0.3s ease;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }

        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.2);
            padding-left: 35px;
        }

        .sidebar-item.active {
            background: rgba(255, 255, 255, 0.3);
            border-right: 4px solid white;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .add-task-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .add-task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #20c997, #17a2b8);
        }        .sidebar {
            display: flex;
            flex-direction: column;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            transform: scale(0.7);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-header h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .modal-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .modal-input {
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
        }

        .modal-input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .modal-btn.secondary {
            background: #6c757d;
            color: white;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .task-delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            cursor: pointer;
            margin-left: 8px;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .sidebar-item:hover .task-delete-btn {
            opacity: 1;
        }        .task-delete-btn:hover {
            background: #c82333;
        }

        /* êµ¬ë¶„ì„  ìŠ¤íƒ€ì¼ */
        .sidebar-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.3);
            margin: 10px 20px;
        }

        /* ìˆœì„œ ë³€ê²½ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .task-order-controls {
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .sidebar-item:hover .task-order-controls {
            opacity: 1;
        }

        .order-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 2px 4px;
            margin: 1px 0;
            border-radius: 2px;
            font-size: 0.6em;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .order-btn:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        .order-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }        /* ê³¼ì œ í•­ëª©ì˜ ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
        .sidebar-item {
            position: relative;
        }

        /* ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .sidebar-item.draggable {
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .sidebar-item.draggable:active {
            cursor: grabbing;
        }

        .sidebar-item.dragging {
            opacity: 0.8;
            transform: scale(0.95);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.3);
            z-index: 1001;
        }

        .sidebar-item.drag-over {
            border-top: 2px dashed rgba(255, 255, 255, 0.7);
            padding-top: 17px;
        }

        .sidebar-item.drag-over-bottom {
            border-bottom: 2px dashed rgba(255, 255, 255, 0.7);
            padding-bottom: 17px;
        }

        .sidebar-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .sidebar-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .main-content {
            margin-left: 0;
            transition: margin-left 0.3s ease;
            padding-top: 80px;
        }

        .main-content.shifted {
            margin-left: 250px;
        }        @media (max-width: 768px) {
            .main-content.shifted {
                margin-left: 0;
            }
            
            .sidebar {
                width: 100%;
                left: -100%;
            }
            
            .sidebar.open {
                left: 0;
            }
            
            .students-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
            }
            
            .student-btn {
                padding: 12px 15px;
                font-size: 0.9em;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <!-- ì‚¬ì´ë“œë°” í† ê¸€ ë²„íŠ¼ -->
    <button class="sidebar-toggle" onclick="toggleSidebar()">
        â˜°
    </button>

    <!-- ì‚¬ì´ë“œë°” ì˜¤ë²„ë ˆì´ -->
    <div class="sidebar-overlay" onclick="closeSidebar()"></div>    <!-- ì‚¬ì´ë“œë°” -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            ğŸ“š í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ
        </div>        <div class="sidebar-nav">            <button class="sidebar-item active" onclick="switchTab('management')">
                ğŸ‘¥ ëª…ë‹¨ ê´€ë¦¬
            </button>
              <!-- êµ¬ë¶„ì„  -->
            <div class="sidebar-divider"></div>
              <button class="sidebar-item draggable" 
                    onclick="switchTab('attendance')"
                    draggable="true"
                    data-task-id="attendance"
                    data-task-type="default"
                    ondragstart="handleUnifiedDragStart(event)"
                    ondragover="handleDragOver(event)"
                    ondrop="handleUnifiedDrop(event)"
                    ondragenter="handleDragEnter(event)"
                    ondragleave="handleDragLeave(event)"
                    ondragend="handleDragEnd(event)">
                âœï¸ ê¿ˆë¬¸ ì œì¶œ
                <span class="task-delete-btn" onclick="event.stopPropagation(); deleteDefaultTask('attendance')">ğŸ—‘ï¸</span>
            </button>
            <button class="sidebar-item draggable" 
                    onclick="switchTab('assignment')"
                    draggable="true"
                    data-task-id="assignment"
                    data-task-type="default"
                    ondragstart="handleUnifiedDragStart(event)"
                    ondragover="handleDragOver(event)"
                    ondrop="handleUnifiedDrop(event)"
                    ondragenter="handleDragEnter(event)"
                    ondragleave="handleDragLeave(event)"
                    ondragend="handleDragEnd(event)">
                ğŸ“‹ ì•Œë¦¼ì¥ ê²€ì‚¬
                <span class="task-delete-btn" onclick="event.stopPropagation(); deleteDefaultTask('assignment')">ğŸ—‘ï¸</span>
            </button>
            <div id="dynamic-tasks">
                <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ëœ ê³¼ì œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
        <div class="sidebar-footer">
            <button class="add-task-btn" onclick="showAddTaskModal()">
                â• ê³¼ì œ ì¶”ê°€
            </button>
        </div>
    </nav>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="main-content" id="mainContent">        <div class="container">
            <h1 id="main-header">ğŸ“š í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>

            <div id="management" class="content active">
                <div class="upload-section">
                    <h3>ğŸ“‹ í•™ìƒ ëª…ë‹¨ ì—…ë¡œë“œ</h3>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div class="file-input-wrapper">
                            <input type="file" id="studentFile" class="file-input" accept=".txt,.csv" onchange="handleFileUpload(event)">
                            <label for="studentFile" class="file-input-label">
                                ğŸ“ ëª…ë‹¨ íŒŒì¼ ì„ íƒ
                            </label>
                        </div>
                    </div>

                    <div class="format-info">
                        <h4>ğŸ“ íŒŒì¼ í˜•ì‹ ì•ˆë‚´</h4>
                        <p><strong>ì§€ì› í˜•ì‹:</strong> .txt, .csv íŒŒì¼</p>
                        <p><strong>í˜•ì‹ ì˜ˆì‹œ:</strong></p>
                        <div style="margin: 10px 0;">
                            <code>1 ê¹€ë¯¼ìˆ˜</code><br>
                            <code>2 ì´ì§€ì€</code><br>
                            <code>3 ë°•ì¤€í˜¸</code><br>
                            <code>...</code>
                        </div>
                        <p><small>* í•œ ì¤„ì— í•˜ë‚˜ì”©, "ë²ˆí˜¸ ì´ë¦„" í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.</small></p>
                    </div>

                    <div style="text-align: center;">
                        <button class="control-btn" onclick="clearStudentList()">ì „ì²´ ëª…ë‹¨ ì‚­ì œ</button>
                    </div>
                </div>

                <div class="add-student-section">
                    <h4>â• í•™ìƒ ê°œë³„ ì¶”ê°€</h4>
                    <div class="add-form">
                        <input type="number" id="studentNumber" class="add-input" placeholder="ë²ˆí˜¸" min="1" style="width: 80px;">
                        <input type="text" id="studentName" class="add-input" placeholder="í•™ìƒ ì´ë¦„" style="width: 150px;">
                        <button class="add-btn" onclick="addSingleStudent()">ì¶”ê°€</button>
                    </div>
                    <p style="text-align: center; margin-top: 10px; color: #6c757d; font-size: 0.9em;">
                        * ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ ë‹¤ìŒ ë²ˆí˜¸ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.
                    </p>
                </div>

                <div class="current-list">
                    <h4>í˜„ì¬ ë“±ë¡ëœ í•™ìƒ ëª…ë‹¨ (<span id="student-count">0</span>ëª…)</h4>
                    <div id="student-list-display">
                        <!-- í˜„ì¬ í•™ìƒ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>

            <div id="attendance" class="content">
                <div class="controls">
                    <button class="control-btn" onclick="resetAll('attendance')">ì „ì²´ ì´ˆê¸°í™”</button>
                    <button class="control-btn" onclick="markAllPresent()">ì „ì²´ ì œì¶œ</button>
                </div>
                <div class="students-grid" id="attendance-grid">
                    <!-- ì¶œì„ ì²´í¬ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
                <div class="summary" id="attendance-summary">
                    <!-- ì¶œì„ ìš”ì•½ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <div id="assignment" class="content">
                <div class="controls">
                    <button class="control-btn" onclick="resetAll('assignment')">ì „ì²´ ì´ˆê¸°í™”</button>
                    <button class="control-btn" onclick="markAllSubmitted()">ì „ì²´ ì œì¶œ</button>
                </div>
                <div class="students-grid" id="assignment-grid">
                    <!-- ê³¼ì œ ì œì¶œ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
                <div class="summary" id="assignment-summary">
                    <!-- ê³¼ì œ ìš”ì•½ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ë™ì  ê³¼ì œ ì»¨í…ì¸ ê°€ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
            <div id="dynamic-task-contents">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„±ëœ ê³¼ì œ í˜ì´ì§€ë“¤ -->
            </div>
        </div>
    </div>

    <!-- ê³¼ì œ ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“ ìƒˆ ê³¼ì œ ì¶”ê°€</h3>
                <p>ìƒˆë¡œìš´ ê³¼ì œë¥¼ ì¶”ê°€í•˜ì—¬ í•™ìƒë“¤ì˜ ì œì¶œ ìƒí™©ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
            </div>
            <div class="modal-form">
                <input type="text" id="taskName" class="modal-input" placeholder="ê³¼ì œ ì´ë¦„ (ì˜ˆ: ìˆ˜í•™ ìˆ™ì œ, ê³¼í•™ ë³´ê³ ì„œ)">
                <input type="text" id="taskIcon" class="modal-input" placeholder="ì•„ì´ì½˜ (ì´ëª¨ì§€ 1ê°œ, ì˜ˆ: ğŸ“–, ğŸ§®, ğŸ”¬)" maxlength="2">
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeAddTaskModal()">ì·¨ì†Œ</button>
                <button class="modal-btn primary" onclick="addNewTask()">ì¶”ê°€</button>
            </div>
        </div>
    </div>    <script>
        // í•™ìƒ ëª…ë‹¨ (ë²ˆí˜¸ì™€ ì´ë¦„ì„ í¬í•¨í•œ ê°ì²´ ë°°ì—´)
        let students = [];

        // ìƒíƒœ ê´€ë¦¬ ê°ì²´ (í•™ìƒID ê¸°ë°˜)
        let attendanceStatus = {};
        let assignmentStatus = {};
        let dynamicTaskStatuses = {}; // ë™ì  ê³¼ì œ ìƒíƒœë“¤        // ë™ì  ê³¼ì œ ëª©ë¡
        let dynamicTasks = [];

        // ì „ì²´ ê³¼ì œ ìˆœì„œ ê´€ë¦¬ (ê¸°ë³¸ ê³¼ì œ + ë™ì  ê³¼ì œ IDë¥¼ ëª¨ë‘ í¬í•¨)
        let allTasksOrder = ['attendance', 'assignment']; // ê¸°ë³¸ ìˆœì„œ

        // localStorage í‚¤
        const STORAGE_KEY = 'student_roster';

        // í•™ìƒ ê³ ìœ  ID ìƒì„± (ë²ˆí˜¸ ê¸°ë°˜)
        function getStudentId(number, name) {
            return `${number}_${name}`;
        }        // ì•± ì‹œì‘ì‹œ ë°ì´í„° ë¡œë“œ
        function loadFromStorage() {
            const storedData = localStorage.getItem(STORAGE_KEY);
            console.log('ì €ì¥ëœ ë°ì´í„° í™•ì¸:', storedData);
            if (storedData) {
                try {
                    const parsedData = JSON.parse(storedData);
                    students = parsedData.students || [];
                    attendanceStatus = parsedData.attendanceStatus || {};
                    assignmentStatus = parsedData.assignmentStatus || {};
                    dynamicTaskStatuses = parsedData.dynamicTaskStatuses || {};
                    dynamicTasks = parsedData.dynamicTasks || [];
                    allTasksOrder = parsedData.allTasksOrder || ['attendance', 'assignment'];
                    console.log('ë°ì´í„° ë¡œë“œ ì„±ê³µ:', parsedData);
                } catch (error) {
                    console.error('ì €ì¥ëœ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                }
            } else {
                console.log('ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        }
                 // localStorageì— ë°ì´í„° ì €ì¥
        function saveToStorage() {
            const dataToSave = {
                students: students,
                attendanceStatus: attendanceStatus,
                assignmentStatus: assignmentStatus,
                dynamicTaskStatuses: dynamicTaskStatuses,
                dynamicTasks: dynamicTasks,
                allTasksOrder: allTasksOrder
            };
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                console.log('ë°ì´í„° ì €ì¥ ì„±ê³µ:', dataToSave);
            } catch (error) {
                console.error('localStorage ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                parseStudentList(content);
            };
            reader.readAsText(file, 'UTF-8');
        }        // í•™ìƒ ëª…ë‹¨ íŒŒì‹±
        function parseStudentList(content) {
            const lines = content.split('\n').filter(line => line.trim());
            const newStudents = [];

            for (let line of lines) {
                line = line.trim();
                if (!line) continue;

                // ë²ˆí˜¸ì™€ ì´ë¦„ì„ ë¶„ë¦¬ (ê³µë°±, íƒ­, ì‰¼í‘œë¡œ ë¶„ë¦¬)
                const parts = line.split(/[\s,]+/);
                if (parts.length >= 2) {
                    const number = parseInt(parts[0]);
                    const name = parts.slice(1).join(' '); // ë‚˜ë¨¸ì§€ë¥¼ ì´ë¦„ìœ¼ë¡œ ê²°í•©
                    
                    if (!isNaN(number) && name) {
                        // ë™ì¼í•œ ë²ˆí˜¸ê°€ ìˆëŠ”ì§€ ì²´í¬
                        const existingStudent = newStudents.find(s => s.number === number);
                        if (existingStudent) {
                            alert(`ì¤‘ë³µëœ ë²ˆí˜¸ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤: ${number}ë²ˆ (${existingStudent.name}, ${name})\níŒŒì¼ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.`);
                            return;
                        }
                        newStudents.push({ number: number, name: name });
                    }
                }
            }

            if (newStudents.length === 0) {
                alert('ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ í•™ìƒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\ní˜•ì‹: "ë²ˆí˜¸ ì´ë¦„"');
                return;
            }

            // ë²ˆí˜¸ ìˆœìœ¼ë¡œ ì •ë ¬
            newStudents.sort((a, b) => a.number - b.number);
            
            // í•™ìƒ ë°°ì—´ ì—…ë°ì´íŠ¸
            students = newStudents;

            // ìƒíƒœ ì´ˆê¸°í™”
            initializeStatuses();
            
            // UI ì—…ë°ì´íŠ¸
            updateUI();
            
            // ì €ì¥
            saveToStorage();

            alert(`${students.length}ëª…ì˜ í•™ìƒì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }        // ìƒíƒœ ì´ˆê¸°í™”
        function initializeStatuses() {
            attendanceStatus = {};
            assignmentStatus = {};
            
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                attendanceStatus[studentId] = 'absent';
                assignmentStatus[studentId] = 'not-submitted';
                
                // ë™ì  ê³¼ì œë“¤ì— ëŒ€í•´ì„œë„ ì´ˆê¸°í™”
                dynamicTasks.forEach(task => {
                    if (!dynamicTaskStatuses[task.id]) {
                        dynamicTaskStatuses[task.id] = {};
                    }
                    dynamicTaskStatuses[task.id][studentId] = 'not-submitted';
                });
            });
        }

        // í•™ìƒ ëª…ë‹¨ ì‚­ì œ
        function clearStudentList() {
            if (confirm('ëª¨ë“  í•™ìƒ ëª…ë‹¨ê³¼ ì¶œì„/ê³¼ì œ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                students = [];
                attendanceStatus = {};
                assignmentStatus = {};
                updateUI();
                saveToStorage();
                alert('í•™ìƒ ëª…ë‹¨ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }        // UI ì „ì²´ ì—…ë°ì´íŠ¸
        function updateUI() {
            createStudentButtons();
            updateSummary('attendance');
            updateSummary('assignment');
            displayCurrentStudentList();
            updateDynamicTasks();
            updateDynamicTaskButtons();
        }// í˜„ì¬ í•™ìƒ ëª©ë¡ í‘œì‹œ
        function displayCurrentStudentList() {
            const listDisplay = document.getElementById('student-list-display');
            const countDisplay = document.getElementById('student-count');
            
            countDisplay.textContent = students.length;
            
            if (students.length === 0) {
                listDisplay.innerHTML = '<p style="text-align: center; color: #6c757d;">ë“±ë¡ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            listDisplay.innerHTML = students.map((student, index) => `
                <div class="student-item">
                    <span><span class="student-number">${student.number}</span>${student.name}</span>
                    <button class="delete-btn" onclick="deleteSingleStudent(${index})" title="ì‚­ì œ">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                </div>
            `).join('');
        }        // í•™ìƒ ê°œë³„ ì¶”ê°€
        function addSingleStudent() {
            const numberInput = document.getElementById('studentNumber');
            const nameInput = document.getElementById('studentName');
            
            const name = nameInput.value.trim();
            if (!name) {
                alert('í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                nameInput.focus();
                return;
            }

            let number = parseInt(numberInput.value);
            
            // ë²ˆí˜¸ê°€ ì—†ìœ¼ë©´ ë‹¤ìŒ ì‚¬ìš© ê°€ëŠ¥í•œ ë²ˆí˜¸ ì°¾ê¸°
            if (isNaN(number) || number < 1) {
                number = getNextAvailableNumber();
            }

            // ì¤‘ë³µ ë²ˆí˜¸ ì²´í¬
            const existingStudent = students.find(s => s.number === number);
            if (existingStudent) {
                alert(`${number}ë²ˆì€ ì´ë¯¸ ${existingStudent.name} í•™ìƒì´ ì‚¬ìš©ì¤‘ì…ë‹ˆë‹¤.\në‹¤ë¥¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                numberInput.focus();
                return;
            }

            // ìƒˆ í•™ìƒ ê°ì²´ ìƒì„±
            const newStudent = { number: number, name: name };
            
            // ë²ˆí˜¸ ìˆœì„œì— ë§ê²Œ ì‚½ì…
            const insertIndex = students.findIndex(s => s.number > number);
            if (insertIndex === -1) {
                students.push(newStudent);
            } else {
                students.splice(insertIndex, 0, newStudent);
            }

            // ìƒíƒœ ì´ˆê¸°í™” (ìƒˆ í•™ìƒ)
            const studentId = getStudentId(number, name);
            attendanceStatus[studentId] = 'absent';
            assignmentStatus[studentId] = 'not-submitted';
            
            // ë™ì  ê³¼ì œë“¤ì— ëŒ€í•´ì„œë„ ì´ˆê¸°í™”
            dynamicTasks.forEach(task => {
                if (!dynamicTaskStatuses[task.id]) {
                    dynamicTaskStatuses[task.id] = {};
                }
                dynamicTaskStatuses[task.id][studentId] = 'not-submitted';
            });

            // UI ì—…ë°ì´íŠ¸
            updateUI();
            saveToStorage();

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            numberInput.value = '';
            nameInput.value = '';
            nameInput.focus();

            alert(`${name} í•™ìƒì´ ${number}ë²ˆìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // ë‹¤ìŒ ì‚¬ìš© ê°€ëŠ¥í•œ ë²ˆí˜¸ ì°¾ê¸°
        function getNextAvailableNumber() {
            if (students.length === 0) return 1;
            
            // 1ë²ˆë¶€í„° ì‹œì‘í•´ì„œ ë¹„ì–´ìˆëŠ” ë²ˆí˜¸ ì°¾ê¸°
            for (let i = 1; i <= students.length + 1; i++) {
                if (!students.find(s => s.number === i)) {
                    return i;
                }
            }
            return students.length + 1;
        }        // í•™ìƒ ê°œë³„ ì‚­ì œ
        function deleteSingleStudent(index) {
            const student = students[index];
            const studentId = getStudentId(student.number, student.name);
            
            if (confirm(`${student.number}ë²ˆ ${student.name} í•™ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ì¶œì„ ë° ê³¼ì œ ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤)`)) {
                // í•™ìƒ ì‚­ì œ
                students.splice(index, 1);
                
                // ìƒíƒœ ë°ì´í„° ì‚­ì œ
                delete attendanceStatus[studentId];
                delete assignmentStatus[studentId];
                
                // ë™ì  ê³¼ì œë“¤ì—ì„œë„ ì‚­ì œ
                dynamicTasks.forEach(task => {
                    if (dynamicTaskStatuses[task.id]) {
                        delete dynamicTaskStatuses[task.id][studentId];
                    }
                });

                // UI ì—…ë°ì´íŠ¸
                updateUI();
                saveToStorage();

                alert(`${student.number}ë²ˆ ${student.name} í•™ìƒì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        // Enter í‚¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('studentName');
            const numberInput = document.getElementById('studentNumber');
            
            if (nameInput) {
                nameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addSingleStudent();
                    }
                });
            }
            
            if (numberInput) {
                numberInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        nameInput.focus();
                    }
                });
            }
        });        // ì´ˆê¸°í™”
        function initializeApp() {
            loadFromStorage();
            
            // ê¸°ì¡´ ë™ì  ê³¼ì œë“¤ì˜ ì»¨í…ì¸  ìƒì„±
            dynamicTasks.forEach(task => {
                createDynamicTaskContent(task);
            });
            
            updateUI();
            updateAllTasksOrder();
            
            // ì´ˆê¸° í—¤ë” ì„¤ì • (ëª…ë‹¨ ê´€ë¦¬ê°€ ê¸°ë³¸ í™œì„± íƒ­)
            updateHeaderTitle('management');
        }// í•™ìƒ ë²„íŠ¼ ìƒì„±
        function createStudentButtons() {
            const attendanceGrid = document.getElementById('attendance-grid');
            const assignmentGrid = document.getElementById('assignment-grid');
            
            attendanceGrid.innerHTML = '';
            assignmentGrid.innerHTML = '';

            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                
                // ì¶œì„ ë²„íŠ¼ ìƒì„±
                const attendanceBtn = document.createElement('button');
                attendanceBtn.className = `student-btn ${attendanceStatus[studentId]}`;
                attendanceBtn.innerHTML = `
                    <div class="student-name">${student.number}ë²ˆ ${student.name}</div>
                    <div class="student-status">${getStatusText(attendanceStatus[studentId], 'attendance')}</div>
                `;
                attendanceBtn.onclick = () => toggleStatus(studentId, 'attendance');
                attendanceGrid.appendChild(attendanceBtn);

                // ê³¼ì œ ë²„íŠ¼ ìƒì„±
                const assignmentBtn = document.createElement('button');
                assignmentBtn.className = `student-btn ${assignmentStatus[studentId]}`;
                assignmentBtn.innerHTML = `
                    <div class="student-name">${student.number}ë²ˆ ${student.name}</div>
                    <div class="student-status">${getStatusText(assignmentStatus[studentId], 'assignment')}</div>
                `;
                assignmentBtn.onclick = () => toggleStatus(studentId, 'assignment');
                assignmentGrid.appendChild(assignmentBtn);
            });
        }

        // ìƒíƒœ í…ìŠ¤íŠ¸ ë°˜í™˜
        function getStatusText(status, type) {
            if (type === 'attendance') {
                return status === 'absent' ? 'ë¯¸ì œì¶œ' : 'ì œì¶œ';
            } else {
                return status === 'not-submitted' ? 'ë¯¸ì œì¶œ' : 'ì œì¶œ';
            }
        }        // ìƒíƒœ í† ê¸€
        function toggleStatus(studentId, type) {
            if (type === 'attendance') {
                attendanceStatus[studentId] = attendanceStatus[studentId] === 'absent' ? 'present' : 'absent';
            } else {
                assignmentStatus[studentId] = assignmentStatus[studentId] === 'not-submitted' ? 'submitted' : 'not-submitted';
            }
            
            createStudentButtons();
            updateSummary(type);
            saveToStorage(); // ìƒíƒœ ë³€ê²½ì‹œ ì €ì¥
        }        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ê³¼ ì»¨í…ì¸  í™œì„±í™”
            event.target.classList.add('active');
            const contentElement = document.getElementById(tabName);
            if (contentElement) {
                contentElement.classList.add('active');
            }
            
            // í—¤ë” ì œëª© ì—…ë°ì´íŠ¸
            updateHeaderTitle(tabName);
            
            // ëª¨ë°”ì¼ì—ì„œëŠ” íƒ­ ì „í™˜ ì‹œ ì‚¬ì´ë“œë°” ìë™ ë‹«ê¸°
            if (window.innerWidth <= 768) {
                closeSidebar();
            }
        }

        // í—¤ë” ì œëª© ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateHeaderTitle(tabName) {
            const headerElement = document.getElementById('main-header');
            if (!headerElement) return;
            
            const titleMap = {
                'management': 'ğŸ“š í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ',
                'attendance': 'âœï¸ ê¿ˆë¬¸ ì œì¶œ',
                'assignment': 'ğŸ“‹ ì•Œë¦¼ì¥ ê²€ì‚¬'
            };
            
            // ë™ì  ê³¼ì œì¸ ê²½ìš°
            const dynamicTask = dynamicTasks.find(task => task.id === tabName);
            if (dynamicTask) {
                headerElement.textContent = `${dynamicTask.icon} ${dynamicTask.name}`;
            } else {
                headerElement.textContent = titleMap[tabName] || 'ğŸ“š í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ';
            }
        }

        // ì‚¬ì´ë“œë°” í† ê¸€
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const overlay = document.querySelector('.sidebar-overlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
            
            // ë°ìŠ¤í¬í†±ì—ì„œë§Œ ë©”ì¸ ì»¨í…ì¸  ì´ë™
            if (window.innerWidth > 768) {
                mainContent.classList.toggle('shifted');
            }
        }

        // ì‚¬ì´ë“œë°” ë‹«ê¸°
        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const overlay = document.querySelector('.sidebar-overlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');            mainContent.classList.remove('shifted');
        }

        // ê³¼ì œ ì¶”ê°€ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showAddTaskModal() {
            document.getElementById('addTaskModal').classList.add('active');
        }

        function closeAddTaskModal() {
            document.getElementById('addTaskModal').classList.remove('active');
            document.getElementById('taskName').value = '';
            document.getElementById('taskIcon').value = '';
        }        function addNewTask() {
            const taskName = document.getElementById('taskName').value.trim();
            const taskIcon = document.getElementById('taskIcon').value.trim();

            if (!taskName) {
                alert('ê³¼ì œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const taskId = 'task_' + Date.now();
            const newTask = {
                id: taskId,
                name: taskName,
                icon: taskIcon || 'ğŸ“'
            };

            dynamicTasks.push(newTask);
            
            // allTasksOrderì—ë„ ìƒˆ ê³¼ì œ ì¶”ê°€
            allTasksOrder.push(taskId);
            
            // ìƒˆ ê³¼ì œì— ëŒ€í•œ ìƒíƒœ ì´ˆê¸°í™”
            dynamicTaskStatuses[taskId] = {};
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                dynamicTaskStatuses[taskId][studentId] = 'not-submitted';
            });

            // UI ì—…ë°ì´íŠ¸
            updateDynamicTasks();
            updateAllTasksOrder();
            createDynamicTaskContent(newTask);
            saveToStorage();
            closeAddTaskModal();

            alert(`"${taskName}" ê³¼ì œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }        function deleteTask(taskId) {
            const task = dynamicTasks.find(t => t.id === taskId);
            if (!task) return;

            if (confirm(`"${task.name}" ê³¼ì œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ëª¨ë“  ì œì¶œ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤)`)) {
                // ê³¼ì œ ì‚­ì œ
                dynamicTasks = dynamicTasks.filter(t => t.id !== taskId);
                delete dynamicTaskStatuses[taskId];

                // allTasksOrderì—ì„œë„ ì œê±°
                allTasksOrder = allTasksOrder.filter(id => id !== taskId);

                // UIì—ì„œ ì œê±°
                const contentElement = document.getElementById(taskId);
                if (contentElement) {
                    contentElement.remove();
                }

                updateDynamicTasks();
                updateAllTasksOrder();
                saveToStorage();

                // ì‚­ì œëœ ê³¼ì œê°€ í˜„ì¬ í™œì„±í™”ëœ íƒ­ì´ë¼ë©´ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ ì´ë™
                if (document.getElementById(taskId) && document.getElementById(taskId).classList.contains('active')) {
                    const firstSidebarItem = document.querySelector('.sidebar-item');
                    if (firstSidebarItem) {
                        firstSidebarItem.click();
                        // í—¤ë”ë„ ì—…ë°ì´íŠ¸
                        const firstTabName = firstSidebarItem.onclick.toString().match(/switchTab\('(.+?)'\)/)?.[1] || 'management';
                        updateHeaderTitle(firstTabName);
                    }
                }

                alert(`"${task.name}" ê³¼ì œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }// ê¸°ë³¸ ê³¼ì œ ì‚­ì œ í•¨ìˆ˜
        function deleteDefaultTask(taskType) {
            const taskNames = {
                'attendance': 'ê¿ˆë¬¸ ì œì¶œ',
                'assignment': 'ì•Œë¦¼ì¥ ê²€ì‚¬'
            };
            
            const taskName = taskNames[taskType];
            if (!taskName) return;
            
            if (confirm(`"${taskName}" ê¸°ë³¸ ê³¼ì œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ëª¨ë“  ìƒíƒœ ë°ì´í„°ê°€ ì‚­ì œë˜ê³  ì‚¬ì´ë“œë°”ì—ì„œ ì œê±°ë©ë‹ˆë‹¤)`)) {
                // í•´ë‹¹ ê³¼ì œì˜ ìƒíƒœ ë°ì´í„° ì™„ì „ ì‚­ì œ
                if (taskType === 'attendance') {
                    attendanceStatus = {};
                    // localStorageì—ì„œë„ í•´ë‹¹ ë°ì´í„° ì™„ì „ ì œê±°
                    const storedData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
                    delete storedData.attendanceStatus;
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(storedData));
                } else if (taskType === 'assignment') {
                    assignmentStatus = {};
                    // localStorageì—ì„œë„ í•´ë‹¹ ë°ì´í„° ì™„ì „ ì œê±°
                    const storedData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
                    delete storedData.assignmentStatus;
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(storedData));
                }
                
                // allTasksOrderì—ì„œë„ ì œê±°
                allTasksOrder = allTasksOrder.filter(id => id !== taskType);
                
                // ì‚¬ì´ë“œë°”ì—ì„œ í•´ë‹¹ í•­ëª© ì œê±°
                const sidebarItems = document.querySelectorAll('.sidebar-item');
                sidebarItems.forEach(item => {
                    if (item.onclick && item.onclick.toString().includes(`switchTab('${taskType}')`)) {
                        item.remove();
                    }
                });
                
                // ë©”ì¸ ì»¨í…ì¸ ì—ì„œ í•´ë‹¹ ì„¹ì…˜ ì œê±°
                const contentElement = document.getElementById(taskType);
                if (contentElement) {
                    contentElement.remove();
                }
                
                // ì‚­ì œëœ ê³¼ì œê°€ í˜„ì¬ í™œì„±í™”ëœ íƒ­ì´ë¼ë©´ ì²« ë²ˆì§¸ íƒ­ìœ¼ë¡œ ì´ë™
                const activeContent = document.querySelector('.content.active');
                if (activeContent && activeContent.id === taskType) {
                    // ì²« ë²ˆì§¸ ì‚¬ì´ë“œë°” í•­ëª©ìœ¼ë¡œ ì´ë™
                    const firstSidebarItem = document.querySelector('.sidebar-item');
                    if (firstSidebarItem) {
                        firstSidebarItem.click();
                        // í—¤ë”ë„ ì—…ë°ì´íŠ¸
                        const firstTabName = firstSidebarItem.onclick.toString().match(/switchTab\('(.+?)'\)/)?.[1] || 'management';
                        updateHeaderTitle(firstTabName);
                    }
                }
                  // ì „ì²´ ë°ì´í„° ë‹¤ì‹œ ì €ì¥í•˜ì—¬ í™•ì‹¤íˆ ë°˜ì˜
                saveToStorage();
                
                alert(`"${taskName}" ê¸°ë³¸ ê³¼ì œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }function updateDynamicTasks() {
            const dynamicTasksContainer = document.getElementById('dynamic-tasks');
            
            dynamicTasksContainer.innerHTML = dynamicTasks.map((task, index) => `
                <button class="sidebar-item draggable" 
                        onclick="switchTab('${task.id}')"
                        draggable="true"
                        data-task-id="${task.id}"
                        data-task-index="${index}"
                        data-task-type="dynamic"
                        ondragstart="handleUnifiedDragStart(event)"
                        ondragover="handleDragOver(event)"
                        ondrop="handleUnifiedDrop(event)"
                        ondragenter="handleDragEnter(event)"
                        ondragleave="handleDragLeave(event)"
                        ondragend="handleDragEnd(event)">
                    ${task.icon} ${task.name}
                    <span class="task-delete-btn" onclick="event.stopPropagation(); deleteTask('${task.id}')">ğŸ—‘ï¸</span>
                </button>
            `).join('');
        }

        function createDynamicTaskContent(task) {
            const dynamicContentContainer = document.getElementById('dynamic-task-contents');
            
            const taskContent = document.createElement('div');
            taskContent.id = task.id;
            taskContent.className = 'content';
            taskContent.innerHTML = `
                <div class="controls">
                    <button class="control-btn" onclick="resetAllDynamic('${task.id}')">ì „ì²´ ì´ˆê¸°í™”</button>
                    <button class="control-btn" onclick="markAllSubmittedDynamic('${task.id}')">ì „ì²´ ì œì¶œ</button>
                </div>
                <div class="students-grid" id="${task.id}-grid">
                    <!-- ë™ì  ê³¼ì œ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
                <div class="summary" id="${task.id}-summary">
                    <!-- ë™ì  ê³¼ì œ ìš”ì•½ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            `;
            
            dynamicContentContainer.appendChild(taskContent);
        }

        function updateDynamicTaskButtons() {
            dynamicTasks.forEach(task => {
                const grid = document.getElementById(`${task.id}-grid`);
                if (!grid) return;

                grid.innerHTML = '';
                
                students.forEach(student => {
                    const studentId = getStudentId(student.number, student.name);
                    const status = dynamicTaskStatuses[task.id][studentId] || 'not-submitted';
                    
                    const btn = document.createElement('button');
                    btn.className = `student-btn ${status}`;
                    btn.innerHTML = `
                        <div class="student-name">${student.number}ë²ˆ ${student.name}</div>
                        <div class="student-status">${getStatusText(status, 'dynamic')}</div>
                    `;
                    btn.onclick = () => toggleDynamicStatus(studentId, task.id);
                    grid.appendChild(btn);
                });

                updateDynamicSummary(task.id);
            });
        }

        function toggleDynamicStatus(studentId, taskId) {
            const currentStatus = dynamicTaskStatuses[taskId][studentId];
            dynamicTaskStatuses[taskId][studentId] = currentStatus === 'not-submitted' ? 'submitted' : 'not-submitted';
            
            updateDynamicTaskButtons();
            saveToStorage();
        }

        function resetAllDynamic(taskId) {
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                dynamicTaskStatuses[taskId][studentId] = 'not-submitted';
            });
            
            updateDynamicTaskButtons();
            saveToStorage();
        }

        function markAllSubmittedDynamic(taskId) {
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                dynamicTaskStatuses[taskId][studentId] = 'submitted';
            });
            
            updateDynamicTaskButtons();
            saveToStorage();
        }

        function updateDynamicSummary(taskId) {
            const summaryElement = document.getElementById(`${taskId}-summary`);
            if (!summaryElement) return;

            const statuses = Object.values(dynamicTaskStatuses[taskId] || {});
            const submittedCount = statuses.filter(status => status === 'submitted').length;
            const totalCount = students.length;

            summaryElement.innerHTML = `
                <strong>ê³¼ì œ ì œì¶œ í˜„í™©:</strong> 
                ì œì¶œ ${submittedCount}ëª… / ë¯¸ì œì¶œ ${totalCount - submittedCount}ëª… / ì „ì²´ ${totalCount}ëª…
                <br>
                <strong>ì œì¶œë¥ :</strong> ${totalCount > 0 ? Math.round((submittedCount / totalCount) * 100) : 0}%
            `;
        }// ì „ì²´ ì´ˆê¸°í™”
        function resetAll(type) {
            if (type === 'attendance') {
                students.forEach(student => {
                    const studentId = getStudentId(student.number, student.name);
                    attendanceStatus[studentId] = 'absent';
                });
            } else {
                students.forEach(student => {
                    const studentId = getStudentId(student.number, student.name);
                    assignmentStatus[studentId] = 'not-submitted';
                });
            }
            
            createStudentButtons();
            updateSummary(type);
            saveToStorage(); // ìƒíƒœ ë³€ê²½ì‹œ ì €ì¥
        }

        // ì „ì²´ ì¶œì„ ì²˜ë¦¬
        function markAllPresent() {
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                attendanceStatus[studentId] = 'present';
            });
            
            createStudentButtons();
            updateSummary('attendance');
            saveToStorage(); // ìƒíƒœ ë³€ê²½ì‹œ ì €ì¥
        }

        // ì „ì²´ ì œì¶œ ì²˜ë¦¬
        function markAllSubmitted() {
            students.forEach(student => {
                const studentId = getStudentId(student.number, student.name);
                assignmentStatus[studentId] = 'submitted';
            });
            
            createStudentButtons();
            updateSummary('assignment');
            saveToStorage(); // ìƒíƒœ ë³€ê²½ì‹œ ì €ì¥
        }

        // ìš”ì•½ ì—…ë°ì´íŠ¸
        function updateSummary(type) {
            const summaryElement = document.getElementById(`${type}-summary`);
            let presentCount = 0;
            let totalCount = students.length;

            if (type === 'attendance') {
                presentCount = Object.values(attendanceStatus).filter(status => status === 'present').length;
                summaryElement.innerHTML = `
                    <strong>ê³¼ì œ ì œì¶œ í˜„í™©:</strong> 
                    ì œì¶œ ${presentCount}ëª… / ë¯¸ì œì¶œì¶œ ${totalCount - presentCount}ëª… / ì „ì²´ ${totalCount}ëª…
                    <br>
                    <strong>ì œì¶œì¶œë¥ :</strong> ${Math.round((presentCount / totalCount) * 100)}%
                `;
            } else {
                presentCount = Object.values(assignmentStatus).filter(status => status === 'submitted').length;
                summaryElement.innerHTML = `
                    <strong>ê³¼ì œ ì œì¶œ í˜„í™©:</strong> 
                    ì œì¶œ ${presentCount}ëª… / ë¯¸ì œì¶œ ${totalCount - presentCount}ëª… / ì „ì²´ ${totalCount}ëª…
                    <br>
                    <strong>ì œì¶œë¥ :</strong> ${Math.round((presentCount / totalCount) * 100)}%
                `;
            }
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê´€ë ¨ ë³€ìˆ˜
        let draggedElement = null;
        let draggedTaskId = null;
        let draggedIndex = null;        // í†µí•©ëœ ë“œë˜ê·¸ ì‹œì‘ í•¸ë“¤ëŸ¬
        function handleUnifiedDragStart(event) {
            draggedElement = event.target;
            draggedTaskId = event.target.dataset.taskId;
            
            event.target.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/html', event.target.outerHTML);
        }        // í†µí•©ëœ ë“œë¡­ í•¸ë“¤ëŸ¬
        function handleUnifiedDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const target = event.target.closest('.sidebar-item.draggable');
            if (target && target !== draggedElement) {
                const targetTaskId = target.dataset.taskId;
                
                // ë“œë¡­ ìœ„ì¹˜ ê²°ì •
                const rect = target.getBoundingClientRect();
                const midY = rect.top + rect.height / 2;
                const insertBefore = event.clientY < midY;
                
                // ì „ì²´ ê³¼ì œ ìˆœì„œ ì¬ë°°ì¹˜
                reorderAllTasks(draggedTaskId, targetTaskId, insertBefore);
                
                // UI ì—…ë°ì´íŠ¸ ë° ì €ì¥
                updateAllTasksOrder();
                saveToStorage();
                
                // ë“œë˜ê·¸ ìƒíƒœ í´ë¦¬ì–´
                clearDragStyles();
            }
        }

        // ë“œë˜ê·¸ ì˜¤ë²„
        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
            
            const target = event.target.closest('.sidebar-item.draggable');
            if (target && target !== draggedElement) {
                const rect = target.getBoundingClientRect();
                const midY = rect.top + rect.height / 2;
                
                // ë§ˆìš°ìŠ¤ê°€ ìš”ì†Œì˜ ìœ„ìª½ ì ˆë°˜ì— ìˆìœ¼ë©´ ìœ„ì— ì‚½ì…, ì•„ë˜ìª½ ì ˆë°˜ì— ìˆìœ¼ë©´ ì•„ë˜ì— ì‚½ì…
                if (event.clientY < midY) {
                    target.classList.remove('drag-over-bottom');
                    target.classList.add('drag-over');
                } else {
                    target.classList.remove('drag-over');
                    target.classList.add('drag-over-bottom');
                }
            }
        }

        // ë“œë˜ê·¸ ì—”í„°
        function handleDragEnter(event) {
            event.preventDefault();
        }

        // ë“œë˜ê·¸ ë¦¬ë¸Œ
        function handleDragLeave(event) {
            const target = event.target.closest('.sidebar-item.draggable');
            if (target) {
                target.classList.remove('drag-over', 'drag-over-bottom');
            }
        }        // ë“œë˜ê·¸ ì‹œì‘ (ë™ì  ê³¼ì œìš© - í†µí•©ë¨)
        function handleDragStart(event) {
            // ì´ í•¨ìˆ˜ëŠ” ì´ì œ handleUnifiedDragStartë¡œ ëŒ€ì²´ë¨
            return handleUnifiedDragStart(event);
        }

        // ë“œë¡­ (ë™ì  ê³¼ì œìš© - í†µí•©ë¨)
        function handleDrop(event) {
            // ì´ í•¨ìˆ˜ëŠ” ì´ì œ handleUnifiedDropìœ¼ë¡œ ëŒ€ì²´ë¨
            return handleUnifiedDrop(event);
        }

        // ë“œë˜ê·¸ ì¢…ë£Œ
        function handleDragEnd(event) {
            clearDragStyles();
        }

        // ë“œë˜ê·¸ ìŠ¤íƒ€ì¼ í´ë¦¬ì–´
        function clearDragStyles() {
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('dragging', 'drag-over', 'drag-over-bottom');
            });
            draggedElement = null;
            draggedTaskId = null;
            draggedIndex = null;
        }

        // ê³¼ì œ ìˆœì„œ ì¬ë°°ì¹˜
        function reorderTasks(fromIndex, toIndex, insertBefore) {
            // ë“œë˜ê·¸ëœ ìš”ì†Œë¥¼ ë°°ì—´ì—ì„œ ì œê±°
            const draggedTask = dynamicTasks.splice(fromIndex, 1)[0];
            
            // ìƒˆë¡œìš´ ìœ„ì¹˜ ê³„ì‚°
            let newIndex = toIndex;
            
            // ì›ë˜ ìœ„ì¹˜ê°€ ìƒˆ ìœ„ì¹˜ë³´ë‹¤ ì•ì— ìˆì—ˆë‹¤ë©´, ì¸ë±ìŠ¤ ì¡°ì •
            if (fromIndex < toIndex) {
                newIndex -= 1;
            }
              // insertBeforeê°€ falseë©´ ìš”ì†Œ ë’¤ì— ì‚½ì…
            if (!insertBefore) {
                newIndex += 1;
            }
            
            // ìƒˆë¡œìš´ ìœ„ì¹˜ì— ìš”ì†Œ ì‚½ì…
            dynamicTasks.splice(newIndex, 0, draggedTask);
        }

        // ê³¼ì œ ìˆœì„œ ë¡œë“œ í•¨ìˆ˜
        function loadTaskOrder() {
            const storedData = localStorage.getItem(STORAGE_KEY);
            if (storedData) {
                try {
                    const parsedData = JSON.parse(storedData);
                    if (parsedData.allTasksOrder) {
                        allTasksOrder = parsedData.allTasksOrder;
                    }
                } catch (error) {
                    console.error('ê³¼ì œ ìˆœì„œ ë¡œë“œ ì‹¤íŒ¨:', error);
                }
            }
        }

        // ê³¼ì œ ìˆœì„œ ì €ì¥ í•¨ìˆ˜
        function saveTaskOrder() {
            const dataToSave = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            dataToSave.allTasksOrder = allTasksOrder;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
        }        // ì „ì²´ ê³¼ì œ ìˆœì„œ ì¬ë°°ì¹˜
        function reorderAllTasks(draggedId, targetId, insertBefore) {
            // allTasksOrderì—ì„œ ë“œë˜ê·¸ëœ ìš”ì†Œì˜ í˜„ì¬ ì¸ë±ìŠ¤
            const draggedIndex = allTasksOrder.indexOf(draggedId);
            const targetIndex = allTasksOrder.indexOf(targetId);
            
            if (draggedIndex === -1 || targetIndex === -1) return;
            
            // ë°°ì—´ì—ì„œ ë“œë˜ê·¸ëœ ìš”ì†Œ ì œê±°
            allTasksOrder.splice(draggedIndex, 1);
            
            // ìƒˆë¡œìš´ ìœ„ì¹˜ ê³„ì‚°
            let newIndex = targetIndex;
            if (draggedIndex < targetIndex) {
                newIndex -= 1;
            }
            
            if (!insertBefore) {
                newIndex += 1;
            }
            
            // ìƒˆë¡œìš´ ìœ„ì¹˜ì— ì‚½ì…
            allTasksOrder.splice(newIndex, 0, draggedId);
            
            // dynamicTasks ë°°ì—´ë„ ìˆœì„œì— ë§ê²Œ ì¬ì •ë ¬
            reorderDynamicTasksArray();
        }

        // ë™ì  ê³¼ì œ ë°°ì—´ì„ allTasksOrderì— ë§ê²Œ ì¬ì •ë ¬
        function reorderDynamicTasksArray() {
            const newDynamicTasks = [];
            
            allTasksOrder.forEach(taskId => {
                if (taskId !== 'attendance' && taskId !== 'assignment') {
                    const task = dynamicTasks.find(t => t.id === taskId);
                    if (task) {
                        newDynamicTasks.push(task);
                    }
                }
            });
            
            dynamicTasks = newDynamicTasks;
        }        // ì „ì²´ ê³¼ì œ ìˆœì„œì— ë”°ë¼ UI ì—…ë°ì´íŠ¸
        function updateAllTasksOrder() {
            const sidebarNav = document.querySelector('.sidebar-nav');
            const managementBtn = sidebarNav.querySelector('[onclick="switchTab(\'management\')"]');
            const divider = sidebarNav.querySelector('.sidebar-divider');
            const dynamicTasksContainer = document.getElementById('dynamic-tasks');
            
            // ê¸°ì¡´ ê³¼ì œ ë²„íŠ¼ë“¤ ì œê±° (ëª…ë‹¨ ê´€ë¦¬ì™€ êµ¬ë¶„ì„  ì œì™¸)
            const taskButtons = sidebarNav.querySelectorAll('.sidebar-item.draggable');
            taskButtons.forEach(btn => btn.remove());
            
            // ë¹ˆ ë™ì  ê³¼ì œ ì»¨í…Œì´ë„ˆ
            dynamicTasksContainer.innerHTML = '';
            
            // allTasksOrderì— ë”°ë¼ ë‹¤ì‹œ ìƒì„±
            allTasksOrder.forEach(taskId => {
                if (taskId === 'attendance') {
                    const btn = createTaskButton('attendance', 'âœï¸ ê¿ˆë¬¸ ì œì¶œ', 'default');
                    sidebarNav.insertBefore(btn, dynamicTasksContainer);
                } else if (taskId === 'assignment') {
                    const btn = createTaskButton('assignment', 'ğŸ“‹ ì•Œë¦¼ì¥ ê²€ì‚¬', 'default');
                    sidebarNav.insertBefore(btn, dynamicTasksContainer);
                } else {
                    // ë™ì  ê³¼ì œ
                    const task = dynamicTasks.find(t => t.id === taskId);
                    if (task) {
                        const btn = createTaskButton(task.id, `${task.icon} ${task.name}`, 'dynamic');
                        dynamicTasksContainer.appendChild(btn);
                    }
                }
            });
        }        // ê³¼ì œ ë²„íŠ¼ ìƒì„± í—¬í¼ í•¨ìˆ˜
        function createTaskButton(taskId, text, type) {
            const button = document.createElement('button');
            button.className = 'sidebar-item draggable';
            button.setAttribute('onclick', `switchTab('${taskId}')`);
            button.setAttribute('draggable', 'true');
            button.setAttribute('data-task-id', taskId);
            button.setAttribute('data-task-type', type);
            
            // ëª¨ë“  ê³¼ì œê°€ ë™ì¼í•œ í†µí•©ëœ í•¸ë“¤ëŸ¬ ì‚¬ìš©
            button.setAttribute('ondragstart', 'handleUnifiedDragStart(event)');
            button.setAttribute('ondragover', 'handleDragOver(event)');
            button.setAttribute('ondrop', 'handleUnifiedDrop(event)');
            button.setAttribute('ondragenter', 'handleDragEnter(event)');
            button.setAttribute('ondragleave', 'handleDragLeave(event)');
            button.setAttribute('ondragend', 'handleDragEnd(event)');
            
            const deleteBtn = document.createElement('span');
            deleteBtn.className = 'task-delete-btn';
            if (type === 'default') {
                deleteBtn.setAttribute('onclick', `event.stopPropagation(); deleteDefaultTask('${taskId}')`);
            } else {
                deleteBtn.setAttribute('onclick', `event.stopPropagation(); deleteTask('${taskId}')`);
            }
            deleteBtn.textContent = 'ğŸ—‘ï¸';
            
            button.innerHTML = text;
            button.appendChild(deleteBtn);
            
            return button;        }

        // ì•± ì‹œì‘
        window.addEventListener('DOMContentLoaded', initializeApp);

        // ...existing code...
    </script>
</body>
</html>